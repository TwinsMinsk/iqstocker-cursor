# –≠—Ç–∞–ø 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ - –†–ï–ê–õ–ò–ó–û–í–ê–ù ‚úÖ

## üéâ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 1. **Onboarding —Å —Ç–µ—Å—Ç–æ–≤—ã–º PRO** ‚úÖ
- **–§–∞–π–ª:** `bot/handlers/start.py`
- **–§—É–Ω–∫—Ü–∏–∏:**
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è TEST_PRO –Ω–∞ 2 –Ω–µ–¥–µ–ª–∏ –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  - –°–æ–æ–±—â–µ–Ω–∏–µ —Å–æ–≥–ª–∞—Å–Ω–æ –¢–ó: "üéâ –°—é—Ä–ø—Ä–∏–∑! –£ —Ç–µ–±—è –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π —Ç–µ—Å—Ç PRO-–ø–ª–∞–Ω–∞ –Ω–∞ 2 –Ω–µ–¥–µ–ª–∏!"
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ FREE –ø–æ—Å–ª–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞
  - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–Ω–µ–π –¥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞

**–ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
```python
# –ù–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ª—É—á–∞—é—Ç TEST_PRO –Ω–∞ 2 –Ω–µ–¥–µ–ª–∏
user = User(
    subscription_type=SubscriptionType.TEST_PRO,
    test_pro_started_at=now,
    subscription_expires_at=test_pro_expires
)

# –õ–∏–º–∏—Ç—ã –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞
limits = Limits(
    analytics_total=1,  # 1 –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
    themes_total=5,     # 5 —Ç–µ–º –≤ –Ω–µ–¥–µ–ª—é
    top_themes_total=1  # –¢–æ–ø-5 —Ç–µ–º
)
```

### 2. **–°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π** ‚úÖ
- **–§–∞–π–ª—ã:** 
  - `core/notifications/notification_manager.py`
  - `core/notifications/scheduler.py`
- **–§—É–Ω–∫—Ü–∏–∏:**
  - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∑–∞ 7 –¥–Ω–µ–π –¥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è TEST_PRO
  - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∑–∞ 2 –¥–Ω—è –¥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è TEST_PRO
  - –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è FREE –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (1 —Ä–∞–∑ –≤ –º–µ—Å—è—Ü)
  - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –Ω–æ–≤—ã—Ö —Ç–µ–º (–µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ)
  - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—è (–µ–∂–µ–º–µ—Å—è—á–Ω–æ)
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∏—Å—Ç–µ–∫—à–∏—Ö TEST_PRO –≤ FREE

**–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:**
- **–ï–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 00:00 UTC:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–µ–∫—à–∏—Ö TEST_PRO –ø–æ–¥–ø–∏—Å–æ–∫
- **–ï–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 12:00 UTC:** –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å–∫–æ—Ä–æ–º –æ–∫–æ–Ω—á–∞–Ω–∏–∏ TEST_PRO
- **–ö–∞–∂–¥—ã–π –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ –≤ 09:00 UTC:** –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –Ω–æ–≤—ã—Ö —Ç–µ–º
- **1-–≥–æ —á–∏—Å–ª–∞ –∫–∞–∂–¥–æ–≥–æ –º–µ—Å—è—Ü–∞ –≤ 10:00 UTC:** –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- **1-–≥–æ —á–∏—Å–ª–∞ –∫–∞–∂–¥–æ–≥–æ –º–µ—Å—è—Ü–∞ –≤ 11:00 UTC:** –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—è

### 3. **–¢–µ–º—ã –∏ —Ç—Ä–µ–Ω–¥—ã** ‚úÖ
- **–§–∞–π–ª—ã:**
  - `bot/handlers/themes.py` (–æ–±–Ω–æ–≤–ª–µ–Ω)
  - `core/ai/theme_manager.py` (–æ–±–Ω–æ–≤–ª–µ–Ω)
- **–§—É–Ω–∫—Ü–∏–∏:**
  - –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–º (1 —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é)
  - –†–∞–∑–Ω—ã–µ –ª–∏–º–∏—Ç—ã –ø–æ –ø–æ–¥–ø–∏—Å–∫–∞–º:
    - FREE: 1 —Ç–µ–º–∞
    - TEST_PRO/PRO: 5 —Ç–µ–º
    - ULTRA: 10 —Ç–µ–º
  - AI –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö —Ç–µ–º –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
  - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ —Ç–µ–º
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã—Ö –ª–∏–º–∏—Ç–æ–≤

**–õ–æ–≥–∏–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ–º:**
```python
# –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Ç–µ–º—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
user_top_themes = self.get_user_top_themes(user_id)
personal_themes = await self.theme_categorizer.generate_personal_themes(user_top_themes)

# –°–º–µ—à–∏–≤–∞–Ω–∏–µ —Å —Ç—Ä–µ–Ω–¥–æ–≤—ã–º–∏ —Ç–µ–º–∞–º–∏
trending_themes = self.get_trending_themes(limit=20)
```

### 4. **–ü–ª–∞—Ç–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å Boosty API** ‚úÖ
- **–§–∞–π–ª—ã:**
  - `core/payments/boosty_handler.py`
  - `bot/handlers/payments.py`
- **–§—É–Ω–∫—Ü–∏–∏:**
  - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Boosty API –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π
  - –°–æ–∑–¥–∞–Ω–∏–µ —Å—Å—ã–ª–æ–∫ –¥–ª—è –æ–ø–ª–∞—Ç—ã –ø–æ–¥–ø–∏—Å–æ–∫
  - –°–∏—Å—Ç–µ–º–∞ —Å–∫–∏–¥–æ–∫:
    - 50% –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å TEST_PRO
    - 30% –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å FREE
  - Webhook –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–ª–∞—Ç–µ–∂–µ–π
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–æ–∫ –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã

**–¶–µ–Ω—ã –∏ —Å–∫–∏–¥–∫–∏:**
- **PRO:** 990 RUB (495 RUB —Å–æ —Å–∫–∏–¥–∫–æ–π 50%)
- **ULTRA:** 1990 RUB (995 RUB —Å–æ —Å–∫–∏–¥–∫–æ–π 50%)

**–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π:**
- `upgrade_pro` - –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ PRO
- `upgrade_ultra` - –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ ULTRA
- `compare_subscriptions` - —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–∞—Ä–∏—Ñ–æ–≤
- `compare_free_pro` - —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ FREE –∏ PRO
- `compare_pro_ultra` - —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ PRO –∏ ULTRA

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –æ—Å–Ω–æ–≤–Ω—ã–º –±–æ—Ç–æ–º
- **–§–∞–π–ª:** `bot/main.py`
- –î–æ–±–∞–≤–ª–µ–Ω –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á (APScheduler)
- –ü–æ–¥–∫–ª—é—á–µ–Ω—ã –Ω–æ–≤—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏
- **–§–∞–π–ª:** `config/settings.py`
- –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è Boosty API
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ª–∏–º–∏—Ç–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ –ø–æ–¥–ø–∏—Å–∫–∏
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∫–∏–¥–æ–∫ –∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
–í—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –º–æ–¥–µ–ª–∏ —É–∂–µ —Å–æ–∑–¥–∞–Ω—ã:
- `User` - —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π TEST_PRO
- `Subscription` - –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏ –ø–æ–¥–ø–∏—Å–æ–∫
- `Limits` - –¥–ª—è –ª–∏–º–∏—Ç–æ–≤ –ø–æ –ø–æ–¥–ø–∏—Å–∫–∞–º
- `ThemeRequest` - –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ —Ç–µ–º
- `GlobalTheme` - –¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω–æ–π –±–∞–∑—ã —Ç–µ–º

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç `test_stage1_implementation.py` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π:

```bash
python test_stage1_implementation.py
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤:**
- ‚úÖ –ü–ª–∞—Ç–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ —Å–∫–∏–¥–æ–∫ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ü–µ–Ω –∏ —Ä–∞—Å—á–µ—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚ö†Ô∏è –¢–µ—Å—Ç—ã –ë–î —Ç—Ä–µ–±—É—é—Ç –∑–∞–ø—É—â–µ–Ω–Ω–æ–≥–æ PostgreSQL

## üìã –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –¢–ó

### ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —Å–æ–≥–ª–∞—Å–Ω–æ –¢–ó:

1. **Onboarding (–ø. 2.1):**
   - ‚úÖ –ê–∫—Ç–∏–≤–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ PRO-–ø–ª–∞–Ω–∞ –Ω–∞ 2 –Ω–µ–¥–µ–ª–∏
   - ‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ "üéâ –°—é—Ä–ø—Ä–∏–∑! –£ —Ç–µ–±—è –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π —Ç–µ—Å—Ç PRO-–ø–ª–∞–Ω–∞ –Ω–∞ 2 –Ω–µ–¥–µ–ª–∏!"
   - ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ FREE –ø–æ—Å–ª–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è

2. **–°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (–ø. 12):**
   - ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∑–∞ 7 –¥–Ω–µ–π –¥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è TEST_PRO
   - ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∑–∞ 2 –¥–Ω—è –¥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è TEST_PRO
   - ‚úÖ –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è FREE –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

3. **–¢–µ–º—ã –∏ —Ç—Ä–µ–Ω–¥—ã (–ø. 6):**
   - ‚úÖ –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–º
   - ‚úÖ –†–∞–∑–Ω—ã–µ –ª–∏–º–∏—Ç—ã –ø–æ –ø–æ–¥–ø–∏—Å–∫–∞–º
   - ‚úÖ AI –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö —Ç–µ–º
   - ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ —Ç–µ–º

4. **–ü–ª–∞—Ç–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (–ø. 3.4):**
   - ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Boosty API
   - ‚úÖ –°–∫–∏–¥–∫–∏ 50% –¥–ª—è TEST_PRO, 30% –¥–ª—è FREE
   - ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π –∏ –∞–∫—Ç–∏–≤–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–æ–∫

## üöÄ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

–í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≠—Ç–∞–ø–∞ 1 —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏ –≥–æ—Ç–æ–≤—ã –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é. –î–ª—è –ø–æ–ª–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ:

1. –ó–∞–ø—É—Å—Ç–∏—Ç—å PostgreSQL
2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è Boosty API
3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞: `python run_bot_venv.py`

**–°–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø:** –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π (–≤–∏–¥–µ–æ—É—Ä–æ–∫–∏, –∫–∞–ª–µ–Ω–¥–∞—Ä—å —Å—Ç–æ–∫–µ—Ä–∞, –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏).
