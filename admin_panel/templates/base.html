<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}IQStocker Admin{% endblock %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="/static/css/admin.css?v=2.2.0" rel="stylesheet">
    <style>
        /* Дополнительные inline-стили для гарантированной работы скролла */
        .sidebar {
            height: 100vh !important;
            display: flex !important;
            flex-direction: column !important;
            overflow: hidden !important;
        }
        .sidebar-nav {
            flex: 1 !important;
            display: flex !important;
            flex-direction: column !important;
            overflow: hidden !important;
            min-height: 0 !important;
        }
        .nav-links-container {
            flex: 1 !important;
            overflow-y: auto !important;
            overflow-x: hidden !important;
        }
        .nav-links-container::-webkit-scrollbar {
            width: 6px !important;
        }
        .nav-links-container::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3) !important;
            border-radius: 3px !important;
        }
        .sidebar-footer {
            flex-shrink: 0 !important;
            margin-top: auto !important;
        }
    </style>
    {% block extra_css %}{% endblock %}
</head>
<body>
    <div class="sidebar" style="height: 100vh; display: flex; flex-direction: column; overflow: hidden;">
        <div class="sidebar-header" style="flex-shrink: 0;">
            <h4><i class="fas fa-chart-line me-2"></i>IQStocker</h4>
            <p class="text-white-50 mb-0">Admin Panel</p>
        </div>
        <nav class="sidebar-nav" style="flex: 1; display: flex; flex-direction: column; overflow: hidden; min-height: 0;">
            <div class="nav-links-container" style="flex: 1; overflow-y: auto; overflow-x: hidden;">
                <a class="nav-link {% if request.url.path == '/dashboard' %}active{% endif %}" href="/dashboard">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>Дашборд</span>
                </a>
                <a class="nav-link {% if request.url.path == '/users' or '/users' in request.url.path %}active{% endif %}" href="/users">
                    <i class="fas fa-user-friends"></i>
                    <span>Управление пользователями</span>
                </a>
                <a class="nav-link {% if request.url.path == '/lexicon' or '/lexicon' in request.url.path %}active{% endif %}" href="/lexicon">
                    <i class="fas fa-comments"></i>
                    <span>Сообщения</span>
                </a>
                <a class="nav-link {% if request.url.path == '/analytics' or '/analytics' in request.url.path %}active{% endif %}" href="/analytics">
                    <i class="fas fa-chart-bar"></i>
                    <span>Аналитика портфеля</span>
                </a>
                <a class="nav-link {% if request.url.path == '/broadcast' or '/broadcast' in request.url.path %}active{% endif %}" href="/broadcast">
                    <i class="fas fa-bullhorn"></i>
                    <span>Рассылка сообщений</span>
                </a>
                <a class="nav-link {% if request.url.path == '/themes' or '/themes' in request.url.path %}active{% endif %}" href="/themes">
                    <i class="fas fa-palette"></i>
                    <span>Управление темами</span>
                </a>
                <a class="nav-link {% if request.url.path == '/broadcast-history' or '/broadcast-history' in request.url.path %}active{% endif %}" href="/broadcast-history">
                    <i class="fas fa-history"></i>
                    <span>История рассылок</span>
                </a>
                <a class="nav-link {% if request.url.path == '/payments' or '/payments' in request.url.path %}active{% endif %}" href="/payments">
                    <i class="fas fa-credit-card"></i>
                    <span>Платежи и подписки</span>
                </a>
                <a class="nav-link {% if request.url.path == '/tariff-limits' or '/tariff-limits' in request.url.path %}active{% endif %}" href="/tariff-limits">
                    <i class="fas fa-cog"></i>
                    <span>Управление тарифами</span>
                </a>
                <a class="nav-link {% if request.url.path == '/referral' or '/referral' in request.url.path %}active{% endif %}" href="/referral">
                    <i class="fas fa-gift"></i>
                    <span>Реферальная программа</span>
                </a>
                <a class="nav-link {% if request.url.path == '/vip-group' or '/vip-group' in request.url.path %}active{% endif %}" href="/vip-group">
                    <i class="fas fa-crown"></i>
                    <span>VIP Group</span>
                </a>
                <a class="nav-link {% if request.url.path == '/payment-test' or '/payment-test' in request.url.path %}active{% endif %}" href="/payment-test">
                    <i class="fas fa-vial"></i>
                    <span>Тест платежей</span>
                </a>
            </div>
            <div class="sidebar-footer" style="flex-shrink: 0; padding: 0.75rem 1rem; border-top: 1px solid rgba(255, 255, 255, 0.1);">
                <a href="/admin/logout" class="btn btn-outline-light btn-sm w-100">
                    <i class="fas fa-sign-out-alt me-1"></i>Выход
                </a>
            </div>
        </nav>
    </div>

    <main class="main-content">
        <div class="content-header">
            <h1>{% block page_title %}Админ Панель{% endblock %}</h1>
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="/dashboard">Главная</a></li>
                    {% block breadcrumb %}{% endblock %}
                </ol>
            </nav>
        </div>
        {% block content %}{% endblock %}
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    {% block scripts %}{% endblock %}
</body>
</html>
